{"componentChunkName":"component---src-templates-blog-post-js","path":"/2021-03-14-react-and-spring-boot/","result":{"data":{"site":{"siteMetadata":{"title":"Effective Coding"}},"markdownRemark":{"id":"914f88ea-dffc-598c-9a94-fcc24e8f0c1c","excerpt":"Introduction Vous avez développé votre application Single Page Application React avec create-react-app, et votre backend avec Spring-Boot. Excellent! Mais…","html":"<h2>Introduction</h2>\n<p>Vous avez développé votre application <em>Single Page Application</em> React avec <em>create-react-app</em>, et votre backend avec <em>Spring-Boot</em>. Excellent! Mais maintenant il faut intégrer tout ça. Ca tombe bien, <em>Spring-Boot</em>, via son paradigme <em>Convention over Configuration</em> permet d’intégrer notre appli SPA, quasiment automatiquement! On va voir comment ça fonctionne dans ce POST.</p>\n<h2>Transpiler l’appli frontend avec <em>create-react-app</em></h2>\n<p>Première étape : on va transpiler et minifier l’application frontend qu’on a développé.\nPour info, notre application réside dans le répertoire <em>src/main/js</em> (mais au aurait pu choisir autre chose, par exemple <em>src/main/webapp</em>).\nOn suppose que vous avez crée votre application avec <em>create-react-app</em>.\nCe dernier propose la commande <em>npm run build</em> qui va générer dans un répertoire <em>build</em> toute notre application prête à l’emploi, trasnpilée et minifiée.\nVoici un exemple de contenu du répertoire build :</p>\n<ul>\n<li>index.html</li>\n<li>favicon.ico</li>\n<li>manifest.json</li>\n<li>static\n<ul>\n<li>css : tous CSS minifiés</li>\n<li>js : tous JS minifiés</li>\n<li>media : toutes images, fichiers divers</li>\n</ul>\n</li>\n</ul>\n<h2>Automatiser la transpilation via maven</h2>\n<p>Maven propose un plugin spécifique pour effectuer la transpilation du frontend automatiquement à chaque build, <em>frontend-maven-plugin</em>.\nIl faut spécifier à ce plugin la version de Node/NPM qu’on souhaite installer, ainsi que les tâches (<em>goal</em>) à lancer. On indique donc :</p>\n<ul>\n<li><em>install</em> pour effectuer un <em>npm install</em>, et installer les dépendance de notre SPA;</li>\n<li><em>run build</em> pour lancer la transpilation/minification vers le répertoire <em>build</em>.</li>\n</ul>\n<p>Voici donc ce qu’il faut ajouter dans le <em>pom.xml</em>, dans <em>build/plugins</em> :</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.github.eirslett<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>frontend-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>${frontend-plugin-plugin.version}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>installDirectory</span><span class=\"token punctuation\">></span></span>target<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>installDirectory</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>workingDirectory</span><span class=\"token punctuation\">></span></span>src/main/js<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>workingDirectory</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>executions</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>execution</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>install node and npm<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goals</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goal</span><span class=\"token punctuation\">></span></span>install-node-and-npm<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goal</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goals</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>nodeVersion</span><span class=\"token punctuation\">></span></span>${node.version}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>nodeVersion</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>npmVersion</span><span class=\"token punctuation\">></span></span>${npm.version}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>npmVersion</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>execution</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>execution</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>npm install<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goals</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goal</span><span class=\"token punctuation\">></span></span>npm<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goal</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goals</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>execution</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>execution</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>npm build<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goals</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goal</span><span class=\"token punctuation\">></span></span>npm<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goal</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goals</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>phase</span><span class=\"token punctuation\">></span></span>prepare-package<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>phase</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>arguments</span><span class=\"token punctuation\">></span></span>run build<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>arguments</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>execution</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>executions</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2>Le répertoire <em>static</em> de Spring-Boot</h2>\n<p>Spring-Boot fourni un répertoire spécifique pour toutes les ressources <em>frontend</em> (HTML, JS, CSS, etc.) : <em>src/main/ressources/static</em>.\nLes fichiers placés dans ce répertoire seront directement copiés dans le JAR final, dans le répertoire <em>static</em> également, et exposés.\nLe contenu du JAR sera de la forme :</p>\n<ul>\n<li>application.properties</li>\n<li>fichiers classes compilés</li>\n<li>static</li>\n</ul>\n<p>Le but est donc de copier dans ce répertoire <em>static</em>, notre appli front transpilée lors de la première étape. Ainsi, elle sera directement exposée via <em>Spring-Boot</em> sans aucune configuration particulière!</p>\n<h2>Copie des fichiers avec plugin <em>copy</em> de Maven</h2>\n<p>Il faut donc copier l’application SPA transpilée depuis le répertoire <em>src/main/js/build</em> vers le répertoire <em>target/static</em> de spring-Boot, afin de générer le JAR qui contiendra toutes les ressources <em>frontend</em> requises. Pour cela, on utilise le plugion Maven <em>copy-ressources</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>maven-resources-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.0.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>executions</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>execution</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>position-react-build<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goals</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goal</span><span class=\"token punctuation\">></span></span>copy-resources<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goal</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goals</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>phase</span><span class=\"token punctuation\">></span></span>prepare-package<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>phase</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>outputDirectory</span><span class=\"token punctuation\">></span></span>${project.build.outputDirectory}/static<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>outputDirectory</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resource</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>directory</span><span class=\"token punctuation\">></span></span>${frontend-src-dir}/build<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>directory</span><span class=\"token punctuation\">></span></span>\n                            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>filtering</span><span class=\"token punctuation\">></span></span>false<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>filtering</span><span class=\"token punctuation\">></span></span>\n                        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resource</span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>execution</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>executions</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Lancer votre JAR via un <em>java -jar votre-fichier-jar</em>, et vous devrez voir votre application React! En plus, fini les problèmes CORS car tout est dans un seul serveur!\nLe tout est accessible dans mon github ici  <a href=\"https://github.com/smaestri/sharebook\">https://github.com/smaestri/sharebook</a></p>","frontmatter":{"title":"Intégrer un frontend React à Spring-Boot","date":"March 14, 2021","description":null}},"previous":{"fields":{"slug":"/2021-04-03-spring-validation-custom-validator/"},"frontmatter":{"title":"Spring Boot et Bean Validation : injecter un repository dans un Validator custom"}},"next":{"fields":{"slug":"/2021-02-21-deploy-to-azure/2021-02-21-deploy-to-azure-app-services/"},"frontmatter":{"title":"Déployer une appli Spring-Boot vers le Cloud avec Azure App Services et les Github Actions"}}},"pageContext":{"id":"914f88ea-dffc-598c-9a94-fcc24e8f0c1c","previousPostId":"4dbc2ed1-e414-577a-9946-fc3d5729ebbb","nextPostId":"eaae743d-0ba5-52d1-a7e1-57ed2be2762d"}},"staticQueryHashes":["2841359383","916993862"],"slicesMap":{}}